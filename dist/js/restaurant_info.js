let restaurant;var newMap;document.addEventListener("DOMContentLoaded",e=>{initMap()}),initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiZGluZGVyYSIsImEiOiJjamtsazl5NWIxd2E3M3Btemp4Njh6eGtrIn0.azq835pUPzRoLuJUX-7b1A",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap))})}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fetchReviewsFromURL=(e=>{if(self.review)return void e(null,self.review);const t=getParameterByName("id");t?DBHelper.fetchReviewById(t,(t,n)=>{self.review=n,n?(fillReviewsHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name;const t=document.getElementById("is_favorite");"true"==e.is_favorite?(console.log(e.is_favorite),t.checked=!0,t.setAttribute("aria-checked","true"),t.innerHTML=`Remove ${e.name} as a favorite`,t.title=`Remove ${e.name} as a favorite`):(console.log(e.is_favorite),t.checked=!1,t.setAttribute("aria-checked","false"),t.innerHTML=`Add ${e.name} as a favorite`,t.title=`Add ${e.name} as a favorite`),console.log("Checked : ",t.checked),t.addEventListener("click",()=>(console.log("Checked Click : ",t.checked),t.checked?(t.setAttribute("aria-checked","true"),t.innerHTML=`Remove ${e.name} as a favorite`,t.title=`Remove ${e.name} as a favorite`,DBHelper.saveFavorite(e.id,"true")):(t.setAttribute("aria-checked","false"),t.innerHTML=`Add ${e.name} as a favorite`,t.title=`Add ${e.name} as a favorite`,DBHelper.saveFavorite(e.id,"false")))),document.getElementById("restaurant-address").innerHTML=e.address;const n=document.getElementById("restaurant-img");n.className="restaurant-img",n.src=DBHelper.imageUrlForRestaurant(e),n.srcset=DBHelper.imageSrcsetForRestaurant(e),n.sizes="(max-width: 350px) 300px, (max-width: 650px) 600px, (min-width: 651px) 800px",n.alt=" ",document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),DBHelper.fetchReviews(e.id,fillReviewsHTML)}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=n,a.appendChild(r);const o=document.createElement("td");o.innerHTML=e[n],a.appendChild(o),t.appendChild(a)}}),fillReviewsHTML=((e,t)=>{self.restaurant.reviews=t,e&&console.log("No reviews",e);const n=document.querySelector(".reviews-container"),a=document.createElement("h2");if(a.setAttribute("tabindex",0),a.innerHTML="Reviews",n.appendChild(a),!t){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void n.appendChild(e)}const r=document.getElementById("reviews-list");t.forEach(e=>{r.appendChild(createReviewHTML(e))}),n.appendChild(r)}),createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("h3");n.innerHTML=e.name,n.className="review-name",t.appendChild(n);const a=document.createElement("p");a.classList.add("rating"),a.innerHTML=`Rating: ${e.rating}`,a.dataset.rating=e.rating,t.appendChild(a);const r=document.createElement("div");r.append(n),r.append(a),r.className="review-info",t.appendChild(r);const o=document.createElement("p");o.classList.add("createdAt");const i=new Date(e.createdAt).toLocaleDateString();o.innerHTML=`Added:- <strong>${i}</strong>`,t.appendChild(o);const s=document.createElement("p"),d=new Date(e.updatedAt).toLocaleDateString();s.innerHTML=`Updated:- <strong>${d}</strong>`,s.classList.add("updatedAt"),t.appendChild(s);const c=document.createElement("div");c.append(o),c.append(s),c.className="review-date",t.appendChild(c);const l=document.createElement("p");return l.classList.add("comments"),l.innerHTML=e.comments,t.appendChild(l),t});const button=document.querySelector("button");button.addEventListener("click",e=>location.reload()),document.addEventListener("DOMContentLoaded",e=>{"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{if("SyncManager"in window){console.log("YESSSSSSSSSS Sync"),console.log(e),document.querySelector("form").addEventListener("submit",t=>{t.preventDefault();const n=document.querySelector("form");let a=new FormData(n),r={restaurant_id:self.restaurant.id,name:a.get("reviewName"),rating:a.get("reviewRate"),comments:a.get("comments"),createdAt:new Date,updatedAt:new Date};dbPromise.then(e=>{return e.transaction("offline-store","readwrite").objectStore("offline-store").put(r)}).then(()=>e.sync.register("reviewSync")).catch(t=>(console.log(t),n.submit(),e.sync.register("reviewSync")))})}})}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibmV3TWFwIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJpbml0TWFwIiwiZXJyb3IiLCJmZXRjaFJlc3RhdXJhbnRGcm9tVVJMIiwiY29uc29sZSIsImNlbnRlciIsImxhdGxuZyIsImxhdCIsImxuZyIsInNlbGYiLCJzY3JvbGxXaGVlbFpvb20iLCJtYXBib3hUb2tlbiIsInRpbGVMYXllciIsImlkIiwiYWRkVG8iLCJmaWxsQnJlYWRjcnVtYiIsIkRCSGVscGVyIiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsImNhbGxiYWNrIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImZldGNoUmV2aWV3c0Zyb21VUkwiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJmZXRjaFJldmlld0J5SWQiLCJyZXZpZXciLCJmaWxsUmV2aWV3c0hUTUwiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsIm5hbWUiLCJpc19mYXZvcml0ZSIsImxvZyIsImZhdm9yaXRlIiwiY2hlY2tlZCIsInNldEF0dHJpYnV0ZSIsInRpdGxlIiwic2F2ZUZhdm9yaXRlIiwiYWRkcmVzcyIsImltYWdlIiwic3JjIiwic3Jjc2V0IiwiaW1hZ2VTcmNzZXRGb3JSZXN0YXVyYW50Iiwic2l6ZXMiLCJjdWlzaW5lIiwiY3Vpc2luZV90eXBlIiwiZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwiLCJvcGVyYXRpbmdIb3VycyIsIm9wZXJhdGluZ19ob3VycyIsImZldGNoUmV2aWV3cyIsImtleSIsInJvdyIsImNyZWF0ZUVsZW1lbnQiLCJkYXkiLCJhcHBlbmRDaGlsZCIsImhvdXJzIiwidGltZSIsInJldmlld3MiLCJjb250YWluZXIiLCJxdWVyeVNlbGVjdG9yIiwibm9SZXZpZXdzIiwidWwiLCJjcmVhdGVSZXZpZXdIVE1MIiwiY2xhc3NOYW1lIiwibGkiLCJyYXRpbmciLCJjbGFzc0xpc3QiLCJkaXYiLCJhcHBlbmQiLCJhZGQiLCJEYXRlIiwiY3JlYXRlZEF0IiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwiY3JlYXRlZERhdGUiLCJ1cGRhdGVkQXQiLCJ1cGRhdGVkRGF0ZSIsImRhdGUiLCJjb21tZW50cyIsImJ1dHRvbiIsImUiLCJsb2NhdGlvbiIsInJlbG9hZCIsIm5hdmlnYXRvciIsInJlYWR5IiwidGhlbiIsInN3cmVnIiwicHJldmVudERlZmF1bHQiLCJuZXdSZXZpZXciLCJmb3JtIiwiZm9ybWRhdGEiLCJyZXN0YXVyYW50X2lkIiwiZGIiLCJ0cmFuc2FjdGlvbiIsIm9iamVjdFN0b3JlIiwiZ2V0Iiwic3luYyIsInJlZ2lzdGVyIiwiY2F0Y2giLCJkYlByb21pc2UiLCJwdXQiLCJlcnIiLCJzdWJtaXQiLCJ1cmwiLCJ3aW5kb3ciLCJocmVmIiwicmVwbGFjZSIsImJyZWFkY3J1bWIiLCJSZWdFeHAiLCJyZXN1bHRzIiwiZXhlYyIsImRlY29kZVVSSUNvbXBvbmVudCJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsV0FDSixJQUFJQyxPQUlKQyxTQUFTQyxpQkFBaUIsbUJBQXFCQyxJQUEvQ0YsWUFPQUcsUUFBVSxNQUFWQSx1QkFBZ0IsQ0FBQUMsRUFBQU4sS0FDZE8sRUFDRUMsUUFBQUYsTUFBV0EsSUFDVEUsS0FBQUEsT0FBY0YsRUFBQUEsSUFBZCxNQUFBLENBREZHLE9BRU8sQ0FBQVQsRUFBQVUsT0FBQUMsSUFBQVgsRUFBQVUsT0FBQUUsS0FDTEMsS0FBS1osR0FDSFEsaUJBQVNULElBRVRjLEVBQUFBLFVBQUFBLG9GQUFpQixDQUhuQkMsWUFBQSw0RkFLRUMsUUFBRixHQUNFRCxZQUFhLDBOQUtiRSxHQUFJLG1CQUNIQyxNQUFNakIsUUFDVGtCLGlCQUNBQyxTQUFTQyx1QkFBdUJSLEtBQUtiLFdBQVlhLEtBQUtaLGFBd0I1RE0sdUJBQTBCZSxDQUFBQSxJQUExQmYsR0FBQUEsS0FBQUEsV0FDeUIsWUFBdkJlLEVBQVN0QixLQUFBQSxLQUFZQSxZQUVu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QyxTQUFBLGVBMUNKQyxNQUFBRyxJQTZDQTlGLFFBQUEwQixJQUFBb0UsR0FWZ0JaLEVBQUthLFNBQ0VoQixFQUFNVSxLQUFLQyxTQUFTLHVCQVkzQy9FLGVBQWlCLEVBQUNuQixFQUFXYSxLQUFLYixjQVNsQ3VCLE1BQUFBLEVBQXFCckIsU0FBT3NHLGVBQVEsY0FDN0JBLEVBQ0hBLFNBQU1DLGNBQWdCQyxNQUN4QjFFLEVBQUFBLFVBQVkyRSxFQUFRM0UsS0FDcEI0RSxFQUFXcEQsWUFBT3FELEtBT25CdEYsbUJBWEQsRUFBQVMsRUFBQXdFLEtBQ09BLElBQ0hBLEVBQU1DLE9BQU92QixTQUFTd0IsTUFDeEIxRSxFQUFPQSxFQUFLMkUsUUFBUSxVQUFXLFFBQy9CLE1BQ0VHLEVBRFksSUFBSUQsY0FBYzdFLHNCQUNkK0UsS0FBS1AsR0FDdkIsT0FBS00sRUFFQUEsRUFBUSxHQUVORSxtQkFBbUJGLEVBQVEsR0FBR0gsUUFBUSxNQUFPLE1BRDNDLEdBRkEiLCJmaWxlIjoicmVzdGF1cmFudF9pbmZvLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnQ7XHJcbnZhciBuZXdNYXA7XHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIG1hcCBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHsgIFxyXG4gIGluaXRNYXAoKTtcclxufSk7XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBsZWFmbGV0IG1hcFxyXG4gKi9cclxuaW5pdE1hcCA9ICgpID0+IHtcclxuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2UgeyAgICAgIFxyXG4gICAgICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XHJcbiAgICAgICAgY2VudGVyOiBbcmVzdGF1cmFudC5sYXRsbmcubGF0LCByZXN0YXVyYW50LmxhdGxuZy5sbmddLFxyXG4gICAgICAgIHpvb206IDE2LFxyXG4gICAgICAgIHNjcm9sbFdoZWVsWm9vbTogZmFsc2VcclxuICAgICAgfSk7XHJcbiAgICAgIEwudGlsZUxheWVyKCdodHRwczovL2FwaS50aWxlcy5tYXBib3guY29tL3Y0L3tpZH0ve3p9L3t4fS97eX0uanBnNzA/YWNjZXNzX3Rva2VuPXttYXBib3hUb2tlbn0nLCB7XHJcbiAgICAgICAgbWFwYm94VG9rZW46ICdway5leUoxSWpvaVpHbHVaR1Z5WVNJc0ltRWlPaUpqYW10c2F6bDVOV0l4ZDJFM00zQnRlbXA0TmpoNmVHdHJJbjAuYXpxODM1cFVQelJvTHVKVVgtN2IxQScsXHJcbiAgICAgICAgbWF4Wm9vbTogMTgsXHJcbiAgICAgICAgYXR0cmlidXRpb246ICdNYXAgZGF0YSAmY29weTsgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL1wiPk9wZW5TdHJlZXRNYXA8L2E+IGNvbnRyaWJ1dG9ycywgJyArXHJcbiAgICAgICAgICAnPGEgaHJlZj1cImh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8yLjAvXCI+Q0MtQlktU0E8L2E+LCAnICtcclxuICAgICAgICAgICdJbWFnZXJ5IMKpIDxhIGhyZWY9XCJodHRwczovL3d3dy5tYXBib3guY29tL1wiPk1hcGJveDwvYT4nLFxyXG4gICAgICAgIGlkOiAnbWFwYm94LnN0cmVldHMnICAgIFxyXG4gICAgICB9KS5hZGRUbyhuZXdNYXApO1xyXG4gICAgICBmaWxsQnJlYWRjcnVtYigpO1xyXG4gICAgICBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHNlbGYucmVzdGF1cmFudCwgc2VsZi5uZXdNYXApO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59ICBcclxuIFxyXG4vKiB3aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcclxuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XHJcbiAgICAgICAgem9vbTogMTYsXHJcbiAgICAgICAgY2VudGVyOiByZXN0YXVyYW50LmxhdGxuZyxcclxuICAgICAgICBzY3JvbGx3aGVlbDogZmFsc2VcclxuICAgICAgfSk7XHJcbiAgICAgIGZpbGxCcmVhZGNydW1iKCk7XHJcbiAgICAgIERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQoc2VsZi5yZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0gKi9cclxuXHJcbi8qKlxyXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXHJcbiAqL1xyXG5mZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gKGNhbGxiYWNrKSA9PiB7XHJcbiAgaWYgKHNlbGYucmVzdGF1cmFudCkgeyAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcclxuICAgIGNhbGxiYWNrKG51bGwsIHNlbGYucmVzdGF1cmFudClcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XHJcbiAgaWYgKCFpZCkgeyAvLyBubyBpZCBmb3VuZCBpbiBVUkxcclxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xyXG4gICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgICAgc2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudDtcclxuICAgICAgaWYgKCFyZXN0YXVyYW50KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xyXG4gICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5mZXRjaFJldmlld3NGcm9tVVJMID0gKGNhbGxiYWNrKSA9PiB7XHJcbiAgaWYgKHNlbGYucmV2aWV3KSB7IC8vIHJlc3RhdXJhbnQgYWxyZWFkeSBmZXRjaGVkIVxyXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXZpZXcpXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGNvbnN0IGlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpO1xyXG4gIGlmICghaWQpIHsgLy8gbm8gaWQgZm91bmQgaW4gVVJMXHJcbiAgICBlcnJvciA9ICdObyByZXN0YXVyYW50IGlkIGluIFVSTCdcclxuICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICB9IGVsc2Uge1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXZpZXdCeUlkKGlkLCAoZXJyb3IsIHJldmlldykgPT4ge1xyXG4gICAgICBzZWxmLnJldmlldyA9IHJldmlldztcclxuICAgICAgaWYgKCFyZXZpZXcpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgZmlsbFJldmlld3NIVE1MKCk7XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIHJldmlldyk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2VcclxuICovXHJcbmZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuXHJcbiAgY29uc3QgZmF2b3JpdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaXNfZmF2b3JpdGUnKTtcclxuXHJcbiAvLyBjaGVjayBpZiBmYXZvcml0ZSBpcyBjbGlja2VkLCBjaGFuZ2UgYXR0cmlidXRlcyBcclxuICBpZihyZXN0YXVyYW50LmlzX2Zhdm9yaXRlID09ICd0cnVlJyApe1xyXG4gICAgY29uc29sZS5sb2cocmVzdGF1cmFudC5pc19mYXZvcml0ZSlcclxuICAgIGZhdm9yaXRlLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgZmF2b3JpdGUuc2V0QXR0cmlidXRlKCdhcmlhLWNoZWNrZWQnLCAndHJ1ZScpO1xyXG4gICAgZmF2b3JpdGUuaW5uZXJIVE1MID0gYFJlbW92ZSAke3Jlc3RhdXJhbnQubmFtZX0gYXMgYSBmYXZvcml0ZWA7XHJcbiAgICBmYXZvcml0ZS50aXRsZSA9IGBSZW1vdmUgJHtyZXN0YXVyYW50Lm5hbWV9IGFzIGEgZmF2b3JpdGVgO1xyXG4gIH0gZWxzZXtcclxuICAgIGNvbnNvbGUubG9nKHJlc3RhdXJhbnQuaXNfZmF2b3JpdGUpXHJcbiAgICBmYXZvcml0ZS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICBmYXZvcml0ZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtY2hlY2tlZCcsICdmYWxzZScpO1xyXG4gICAgZmF2b3JpdGUuaW5uZXJIVE1MID0gYEFkZCAke3Jlc3RhdXJhbnQubmFtZX0gYXMgYSBmYXZvcml0ZWA7XHJcbiAgICBmYXZvcml0ZS50aXRsZSA9IGBBZGQgJHtyZXN0YXVyYW50Lm5hbWV9IGFzIGEgZmF2b3JpdGVgO1xyXG4gIH1cclxuICBjb25zb2xlLmxvZygnQ2hlY2tlZCA6ICcsIGZhdm9yaXRlLmNoZWNrZWQpO1xyXG5cclxuLy8gd2hlbiBmYXZvcml0ZSBpcyBjbGlja2VkIHVwZGF0ZSBzZXJ2ZXIgYW5kIGNoYW5nZSBhdHRyaWJ1dGVzXHJcbiAgZmF2b3JpdGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZygnQ2hlY2tlZCBDbGljayA6ICcsIGZhdm9yaXRlLmNoZWNrZWQpO1xyXG4gICAgaWYoIGZhdm9yaXRlLmNoZWNrZWQpe1xyXG4gICAgICBmYXZvcml0ZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtY2hlY2tlZCcsICd0cnVlJyk7XHJcbiAgICAgIGZhdm9yaXRlLmlubmVySFRNTCA9IGBSZW1vdmUgJHtyZXN0YXVyYW50Lm5hbWV9IGFzIGEgZmF2b3JpdGVgO1xyXG4gICAgICBmYXZvcml0ZS50aXRsZSA9IGBSZW1vdmUgJHtyZXN0YXVyYW50Lm5hbWV9IGFzIGEgZmF2b3JpdGVgOyBcclxuICAgICByZXR1cm4gREJIZWxwZXIuc2F2ZUZhdm9yaXRlKHJlc3RhdXJhbnQuaWQsICd0cnVlJyk7ICBcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBmYXZvcml0ZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtY2hlY2tlZCcsICdmYWxzZScpO1xyXG4gICAgICBmYXZvcml0ZS5pbm5lckhUTUwgPSBgQWRkICR7cmVzdGF1cmFudC5uYW1lfSBhcyBhIGZhdm9yaXRlYDtcclxuICAgICAgZmF2b3JpdGUudGl0bGUgPSBgQWRkICR7cmVzdGF1cmFudC5uYW1lfSBhcyBhIGZhdm9yaXRlYDsgICAgIFxyXG4gICAgIHJldHVybiBEQkhlbHBlci5zYXZlRmF2b3JpdGUocmVzdGF1cmFudC5pZCwgJ2ZhbHNlJyk7XHJcbiAgICB9XHJcblxyXG5cclxufSk7XHJcblxyXG5cclxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xyXG4gIGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xyXG5cclxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWltZycpO1xyXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZydcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgaW1hZ2Uuc3Jjc2V0ID0gREJIZWxwZXIuaW1hZ2VTcmNzZXRGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gIGltYWdlLnNpemVzID0gXCIobWF4LXdpZHRoOiAzNTBweCkgMzAwcHgsIChtYXgtd2lkdGg6IDY1MHB4KSA2MDBweCwgKG1pbi13aWR0aDogNjUxcHgpIDgwMHB4XCI7XHJcbiAgaW1hZ2UuYWx0ID0gXCIgXCI7XHJcbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcclxuICBjdWlzaW5lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlO1xyXG5cclxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xyXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xyXG4gICAgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKTtcclxuICB9XHJcbiAgLy8gZmlsbCByZXZpZXdzXHJcbiAgREJIZWxwZXIuZmV0Y2hSZXZpZXdzKHJlc3RhdXJhbnQuaWQsIGZpbGxSZXZpZXdzSFRNTCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAob3BlcmF0aW5nSG91cnMgPSBzZWxmLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSA9PiB7XHJcbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xyXG4gIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xyXG4gICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcclxuXHJcbiAgICBjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xyXG4gICAgZGF5LmlubmVySFRNTCA9IGtleTtcclxuICAgIHJvdy5hcHBlbmRDaGlsZChkYXkpO1xyXG5cclxuICAgIGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xyXG4gICAgdGltZS5pbm5lckhUTUwgPSBvcGVyYXRpbmdIb3Vyc1trZXldO1xyXG4gICAgcm93LmFwcGVuZENoaWxkKHRpbWUpO1xyXG4gICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5maWxsUmV2aWV3c0hUTUwgPSAoZXJyb3IsIHJldmlld3MpID0+IHtcclxuICBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cyA9IHJldmlld3M7XHJcblxyXG4gIGlmIChlcnJvcikge1xyXG4gICAgY29uc29sZS5sb2coJ05vIHJldmlld3MnLCBlcnJvcik7XHJcbiAgfVxyXG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXZpZXdzLWNvbnRhaW5lcicpO1xyXG4gIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcclxuICB0aXRsZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7XHJcbiAgdGl0bGUuaW5uZXJIVE1MID0gJ1Jldmlld3MnO1xyXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcblxyXG4gIFxyXG5cclxuICBpZiAoIXJldmlld3MpIHtcclxuICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIG5vUmV2aWV3cy5pbm5lckhUTUwgPSAnTm8gcmV2aWV3cyB5ZXQhJztcclxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChub1Jldmlld3MpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcclxuICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcclxuICAgIC8vIHJldmlldyA9IERCSGVscGVyLmZldGNoUmV2aWV3QnlJZChpZCwgKGVycm9yLCByZXZpZXdzKSk7XHJcbiAgICB1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpO1xyXG4gIH0pO1xyXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bCk7XHJcblxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5jcmVhdGVSZXZpZXdIVE1MID0gKHJldmlldykgPT4ge1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICBcclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xyXG4gIG5hbWUuY2xhc3NOYW1lID0gJ3Jldmlldy1uYW1lJztcclxuICBsaS5hcHBlbmRDaGlsZChuYW1lKTtcclxuXHJcbiAgY29uc3QgcmF0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIHJhdGluZy5jbGFzc0xpc3QuYWRkKCdyYXRpbmcnKTtcclxuICByYXRpbmcuaW5uZXJIVE1MID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWA7XHJcbiAgcmF0aW5nLmRhdGFzZXQucmF0aW5nID0gcmV2aWV3LnJhdGluZztcclxuICBsaS5hcHBlbmRDaGlsZChyYXRpbmcpO1xyXG5cclxuICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICBkaXYuYXBwZW5kKG5hbWUpO1xyXG4gIGRpdi5hcHBlbmQocmF0aW5nKTtcclxuICBkaXYuY2xhc3NOYW1lID0gJ3Jldmlldy1pbmZvJztcclxuICBsaS5hcHBlbmRDaGlsZChkaXYpO1xyXG5cclxuICBjb25zdCBjcmVhdGVkQXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgY3JlYXRlZEF0LmNsYXNzTGlzdC5hZGQoJ2NyZWF0ZWRBdCcpO1xyXG4gIGNvbnN0IGNyZWF0ZWREYXRlID0gbmV3IERhdGUocmV2aWV3LmNyZWF0ZWRBdCkudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XHJcbiAgY3JlYXRlZEF0LmlubmVySFRNTCA9IGBBZGRlZDotIDxzdHJvbmc+JHtjcmVhdGVkRGF0ZX08L3N0cm9uZz5gO1xyXG4gIGxpLmFwcGVuZENoaWxkKGNyZWF0ZWRBdCk7XHJcblxyXG4gIGNvbnN0IHVwZGF0ZWRBdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBjb25zdCB1cGRhdGVkRGF0ZSA9IG5ldyBEYXRlKHJldmlldy51cGRhdGVkQXQpLnRvTG9jYWxlRGF0ZVN0cmluZygpO1xyXG4gIHVwZGF0ZWRBdC5pbm5lckhUTUwgPSBgVXBkYXRlZDotIDxzdHJvbmc+JHt1cGRhdGVkRGF0ZX08L3N0cm9uZz5gO1xyXG4gIHVwZGF0ZWRBdC5jbGFzc0xpc3QuYWRkKCd1cGRhdGVkQXQnKTtcclxuICBsaS5hcHBlbmRDaGlsZCh1cGRhdGVkQXQpO1xyXG5cclxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgZGF0ZS5hcHBlbmQoY3JlYXRlZEF0KTtcclxuICBkYXRlLmFwcGVuZCh1cGRhdGVkQXQpO1xyXG4gIGRhdGUuY2xhc3NOYW1lID0gJ3Jldmlldy1kYXRlJztcclxuICBsaS5hcHBlbmRDaGlsZChkYXRlKTtcclxuXHJcbiAgY29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgY29tbWVudHMuY2xhc3NMaXN0LmFkZCgnY29tbWVudHMnKTtcclxuICBjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHM7XHJcbiAgbGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpO1xyXG4gIHJldHVybiBsaTtcclxuXHJcblxyXG59XHJcblxyXG5jb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdidXR0b24nKTtcclxuLy8gcmVsb2FkIHRvIHNlZSByZXZpZXc7XHJcbmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xyXG4gIHJldHVybiBsb2NhdGlvbi5yZWxvYWQoKTtcclxufSk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGUpID0+IHtcclxuLy8gZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5pZignc2VydmljZVdvcmtlcicgaW4gbmF2aWdhdG9yKXtcclxuIFxyXG4gICAgICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlYWR5LnRoZW4oc3dyZWcgPT4geyBcclxuICAgICAgICAgIGlmKCdTeW5jTWFuYWdlcicgaW4gd2luZG93KXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1lFU1NTU1NTU1NTUyBTeW5jJyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN3cmVnKTtcclxuICAgICAgICAgICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKTtcclxuXHJcbiAgICAgICAgICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZSA9PiB7XHJcbiAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybScpO1xyXG4gICAgICAgICAgXHJcbiAgIFxyXG4gICAgICAgICAgICBsZXQgZm9ybWRhdGEgPSBuZXcgRm9ybURhdGEoZm9ybSk7XHJcbiAgICAgICAgICAgICBsZXQgbmV3UmV2aWV3ID0ge1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAgICAgIFwicmVzdGF1cmFudF9pZFwiOiBzZWxmLnJlc3RhdXJhbnQuaWQsXHJcbiAgICAgICAgICAgICAgIFwibmFtZVwiOiBmb3JtZGF0YS5nZXQoJ3Jldmlld05hbWUnKSxcclxuICAgICAgICAgICAgICAgXCJyYXRpbmdcIjogZm9ybWRhdGEuZ2V0KCdyZXZpZXdSYXRlJyksXHJcbiAgICAgICAgICAgICAgIFwiY29tbWVudHNcIjogZm9ybWRhdGEuZ2V0KCdjb21tZW50cycpLFxyXG4gICAgICAgICAgICAgICBcImNyZWF0ZWRBdFwiOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICBcInVwZGF0ZWRBdFwiOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGRiUHJvbWlzZS50aGVuKGRiID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnN0IGZ4ID0gZGIudHJhbnNhY3Rpb24oJ3Jldmlldy1zdG9yZScsICdyZWFkd3JpdGUnKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24oJ29mZmxpbmUtc3RvcmUnLCAncmVhZHdyaXRlJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHgub2JqZWN0U3RvcmUoJ29mZmxpbmUtc3RvcmUnKS5wdXQobmV3UmV2aWV3KTtcclxuICAgICAgICAgICAgICAgfSkudGhlbigoKT0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzd3JlZy5zeW5jLnJlZ2lzdGVyKCdyZXZpZXdTeW5jJyk7XHJcbiAgICAgICAgICAgICAgIH0pLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgZm9ybS5zdWJtaXQoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzd3JlZy5zeW5jLnJlZ2lzdGVyKCdyZXZpZXdTeW5jJyk7XHJcbiAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyB9KVxyXG4gICAgICAgICAgfSk7ICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICB9KTtcclxuICAgfVxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxyXG4gKi9cclxuZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudD1zZWxmLnJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBicmVhZGNydW1iID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JyZWFkY3J1bWInKTtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgbGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG4gIGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpO1xyXG59XHJcbi8qKlxyXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxyXG4gKi9cclxuZ2V0UGFyYW1ldGVyQnlOYW1lID0gKG5hbWUsIHVybCkgPT4ge1xyXG4gIGlmICghdXJsKVxyXG4gICAgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpO1xyXG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxyXG4gICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKTtcclxuICBpZiAoIXJlc3VsdHMpXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICBpZiAoIXJlc3VsdHNbMl0pXHJcbiAgICByZXR1cm4gJyc7XHJcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcclxufVxyXG4iXX0=
