let restaurants,neighborhoods,cuisines;var newMap,markers=[];document.addEventListener("DOMContentLoaded",e=>{initMap(),fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})}),initMap=(()=>{self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiZGluZGVyYSIsImEiOiJjamtsazl5NWIxd2E3M3Btemp4Njh6eGtrIn0.azq835pUPzRoLuJUX-7b1A",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),a=e.selectedIndex,s=t.selectedIndex,n=e[a].value,r=t[s].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(n,r,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers&&self.markers.forEach(e=>e.remove()),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()}),createRestaurantHTML=(e=>{const t=document.createElement("li"),a=document.createElement("img");a.className="restaurant-img",a.src=DBHelper.imageUrlForRestaurant(e),a.srcset=DBHelper.imageSrcsetForIndex(e),a.sizes="300px",a.alt=`photograph of ${e.name} restaurant`;const s=document.createElement("div");s.classList.add("head_name"),t.append(s),s.append(a);const n=document.createElement("div");n.className="restaurant-info",t.tabIndex="0",t.append(n);const r=document.createElement("h2");r.className="restaurant-name",r.innerHTML=e.name,n.append(r);const o=document.createElement("div");o.classList.add("fav_list"),s.append(o);const c=document.createElement("input");c.className="is_favorite",c.setAttribute("role","checkbox"),c.type="checkbox",c.name="favorite";const i=document.createElement("label");i.className="checkbox-label","true"==e.is_favorite?(console.log(e.is_favorite),c.checked=!0,c.setAttribute("aria-checked","true"),c.innerHTML=`Remove ${e.name} as a favorite`,c.title=`Remove ${e.name} as a favorite`):(console.log(e.is_favorite),c.checked=!1,c.setAttribute("aria-checked","false"),c.innerHTML=`Add ${e.name} as a favorite`,c.title=`Add ${e.name} as a favorite`),console.log("Checked : ",c.checked),c.addEventListener("click",()=>(console.log("Checked Click : ",c.checked),c.checked?(c.setAttribute("aria-checked","true"),c.innerHTML=`Remove ${e.name} as a favorite`,c.title=`Remove ${e.name} as a favorite`,DBHelper.saveFavorite(e.id,"true")):(c.setAttribute("aria-checked","false"),c.innerHTML=`Add ${e.name} as a favorite`,c.title=`Add ${e.name} as a favorite`,DBHelper.saveFavorite(e.id,"false")))),o.append(c),o.append(i),s.append(o);const l=document.createElement("p");l.innerHTML=e.neighborhood,n.append(l);const d=document.createElement("p");d.innerHTML=e.address,n.append(d);const m=document.createElement("a");return m.innerHTML="View Details",m.href=DBHelper.urlForRestaurant(e),n.append(m),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.newMap);t.on("click",function(){window.location.href=t.options.url}),self.markers.push(t)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJuZXdNYXAiLCJtYXJrZXJzIiwiaW5pdE1hcCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImZldGNoTmVpZ2hib3Job29kcyIsImZldGNoQ3Vpc2luZXMiLCJEQkhlbHBlciIsImVycm9yIiwiY29uc29sZSIsInNlbGYiLCJmaWxsTmVpZ2hib3Job29kc0hUTUwiLCJzZWxlY3QiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwibmVpZ2hib3Job29kIiwib3B0aW9uIiwiaW5uZXJIVE1MIiwiZmlsbEN1aXNpbmVzSFRNTCIsImZvckVhY2giLCJjdWlzaW5lIiwiY3JlYXRlRWxlbWVudCIsIkwiLCJtYXAiLCJjZW50ZXIiLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiaWQiLCJ1cGRhdGVSZXN0YXVyYW50cyIsImNTZWxlY3QiLCJuU2VsZWN0Iiwic2VsZWN0ZWRJbmRleCIsImNJbmRleCIsIm5JbmRleCIsInZhbHVlIiwiZmlsbFJlc3RhdXJhbnRzSFRNTCIsInJlc2V0UmVzdGF1cmFudHMiLCJtYXJrZXIiLCJyZW1vdmUiLCJ1bCIsInJlc3RhdXJhbnQiLCJhcHBlbmQiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsImFkZE1hcmtlcnNUb01hcCIsImxpIiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJuYW1lIiwiaGVhZE5hbWUiLCJkaXZJbmZvIiwidGFiSW5kZXgiLCJmYXZfZGl2IiwiY2xhc3NMaXN0IiwiZmF2b3JpdGUiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJsYWJlbCIsImlzX2Zhdm9yaXRlIiwibG9nIiwidGl0bGUiLCJjaGVja2VkIiwic2F2ZUZhdm9yaXRlIiwiYWRkcmVzcyIsIm1vcmUiLCJocmVmIiwidXJsRm9yUmVzdGF1cmFudCIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJvbiIs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ZjJCLEVBQUFiLEdBQUEsWUFJQXNCLEVBQVFSLE9BQU9xQixHQUVmWCxFQUFNWSxPQUFPcEQsR0FDYm9ELEVBQUtoRCxPQUFMb0MsR0FFQUYsTUFBQUEsRUFBQXRDLFNBQUFRLGNBQUEsS0FFQU4sRUFBQUUsVUFBQXlCLEVBQUEzQixhQS9GRm9DLEVBQUFSLE9BQUE1QixHQXNGRSxNQUFNaUQsRUFBVW5ELFNBQVNRLGNBQWMsS0FDdkMyQyxFQUFRL0MsVUFBWXlCLEVBQVdzQixRQUMvQmIsRUFBUVIsT0FBT3FCLEdBY2pCbkIsTUFBQUEsRUFBZWhDLFNBQUloQixjQUFtQkEsS0FQcEMsT0FRQUEsRUFBQUEsVUFBWXNCLGVBQ1Y4QyxFQUFBQyxLQUFBM0QsU0FBQTRELGlCQUFBekIsR0FDQVMsRUFBTVosT0FBTTBCLEdBVlBuQixJQWtCUkQsZ0JBWEQsRUFBQWhELEVBQUFhLEtBQUFiLGVBWUFBLEVBQUFzQixRQUFBdUIsSUFUSSxNQUFNSCxFQUFTaEMsU0FBUzZELHVCQUF1QjFCLEVBQVloQyxLQUFLVixRQUNoRXVDLEVBQU84QixHQUFHLFFBQ1YsV0FDRUMsT0FBT0MsU0FBU0wsS0FBTzNCLEVBQU9pQyxRQUFRQyxNQUV4Qy9ELEtBQUtULFFBQVF5RSxLQUFLbkMiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCByZXN0YXVyYW50cyxcclxuICBuZWlnaGJvcmhvb2RzLFxyXG4gIGN1aXNpbmVzXHJcbnZhciBuZXdNYXBcclxudmFyIG1hcmtlcnMgPSBbXVxyXG4vKipcclxuICogRmV0Y2ggbmVpZ2hib3Job29kcyBhbmQgY3Vpc2luZXMgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXHJcbiAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7XHJcbiAgaW5pdE1hcCgpOyAvLyBhZGRlZCBcclxuICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcclxuICBmZXRjaEN1aXNpbmVzKCk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoTmVpZ2hib3Job29kcyA9ICgpID0+IHtcclxuICBEQkhlbHBlci5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZi5uZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcztcclxuICAgICAgZmlsbE5laWdoYm9yaG9vZHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxyXG4gKi9cclxuZmlsbE5laWdoYm9yaG9vZHNIVE1MID0gKG5laWdoYm9yaG9vZHMgPSBzZWxmLm5laWdoYm9yaG9vZHMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuICBuZWlnaGJvcmhvb2RzLmZvckVhY2gobmVpZ2hib3Job29kID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IG5laWdoYm9yaG9vZDtcclxuICAgIG9wdGlvbi52YWx1ZSA9IG5laWdoYm9yaG9vZDtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLmN1aXNpbmVzID0gY3Vpc2luZXM7XHJcbiAgICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxyXG4gKi9cclxuZmlsbEN1aXNpbmVzSFRNTCA9IChjdWlzaW5lcyA9IHNlbGYuY3Vpc2luZXMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcblxyXG4gIGN1aXNpbmVzLmZvckVhY2goY3Vpc2luZSA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBjdWlzaW5lO1xyXG4gICAgb3B0aW9uLnZhbHVlID0gY3Vpc2luZTtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgbGVhZmxldCBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXHJcbiAqL1xyXG5pbml0TWFwID0gKCkgPT4ge1xyXG4gIHNlbGYubmV3TWFwID0gTC5tYXAoJ21hcCcsIHtcclxuICAgICAgICBjZW50ZXI6IFs0MC43MjIyMTYsIC03My45ODc1MDFdLFxyXG4gICAgICAgIHpvb206IDEyLFxyXG4gICAgICAgIHNjcm9sbFdoZWVsWm9vbTogZmFsc2VcclxuICAgICAgfSk7XHJcbiAgTC50aWxlTGF5ZXIoJ2h0dHBzOi8vYXBpLnRpbGVzLm1hcGJveC5jb20vdjQve2lkfS97en0ve3h9L3t5fS5qcGc3MD9hY2Nlc3NfdG9rZW49e21hcGJveFRva2VufScsIHtcclxuICAgIG1hcGJveFRva2VuOiAncGsuZXlKMUlqb2laR2x1WkdWeVlTSXNJbUVpT2lKamFtdHNhemw1TldJeGQyRTNNM0J0ZW1wNE5qaDZlR3RySW4wLmF6cTgzNXBVUHpSb0x1SlVYLTdiMUEnLFxyXG4gICAgbWF4Wm9vbTogMTgsXHJcbiAgICBhdHRyaWJ1dGlvbjogJ01hcCBkYXRhICZjb3B5OyA8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvXCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzLCAnICtcclxuICAgICAgJzxhIGhyZWY9XCJodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktc2EvMi4wL1wiPkNDLUJZLVNBPC9hPiwgJyArXHJcbiAgICAgICdJbWFnZXJ5IMKpIDxhIGhyZWY9XCJodHRwczovL3d3dy5tYXBib3guY29tL1wiPk1hcGJveDwvYT4nLFxyXG4gICAgaWQ6ICdtYXBib3guc3RyZWV0cydcclxuICB9KS5hZGRUbyhuZXdNYXApO1xyXG5cclxuICB1cGRhdGVSZXN0YXVyYW50cygpO1xyXG59XHJcbi8qIHdpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gIGxldCBsb2MgPSB7XHJcbiAgICBsYXQ6IDQwLjcyMjIxNixcclxuICAgIGxuZzogLTczLjk4NzUwMVxyXG4gIH07XHJcbiAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xyXG4gICAgem9vbTogMTIsXHJcbiAgICBjZW50ZXI6IGxvYyxcclxuICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gIH0pO1xyXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbn0gKi9cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgcGFnZSBhbmQgbWFwIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzLlxyXG4gKi9cclxudXBkYXRlUmVzdGF1cmFudHMgPSAoKSA9PiB7XHJcbiAgY29uc3QgY1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuICBjb25zdCBuU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcblxyXG4gIGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuICBjb25zdCBuSW5kZXggPSBuU2VsZWN0LnNlbGVjdGVkSW5kZXg7XHJcblxyXG4gIGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xyXG5cclxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCAoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlc2V0UmVzdGF1cmFudHMocmVzdGF1cmFudHMpO1xyXG4gICAgICBmaWxsUmVzdGF1cmFudHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIENsZWFyIGN1cnJlbnQgcmVzdGF1cmFudHMsIHRoZWlyIEhUTUwgYW5kIHJlbW92ZSB0aGVpciBtYXAgbWFya2Vycy5cclxuICovXHJcbnJlc2V0UmVzdGF1cmFudHMgPSAocmVzdGF1cmFudHMpID0+IHtcclxuICAvLyBSZW1vdmUgYWxsIHJlc3RhdXJhbnRzXHJcbiAgc2VsZi5yZXN0YXVyYW50cyA9IFtdO1xyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKTtcclxuICB1bC5pbm5lckhUTUwgPSAnJztcclxuXHJcbiAgLy8gUmVtb3ZlIGFsbCBtYXAgbWFya2Vyc1xyXG4gIGlmIChzZWxmLm1hcmtlcnMpIHtcclxuICAgIHNlbGYubWFya2Vycy5mb3JFYWNoKG1hcmtlciA9PiBtYXJrZXIucmVtb3ZlKCkpO1xyXG4gIH1cclxuICBzZWxmLm1hcmtlcnMgPSBbXTtcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gcmVzdGF1cmFudHM7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJlc3RhdXJhbnRzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJlc3RhdXJhbnRzSFRNTCA9IChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIHVsLmFwcGVuZChjcmVhdGVSZXN0YXVyYW50SFRNTChyZXN0YXVyYW50KSk7XHJcbiAgfSk7XHJcbiAgYWRkTWFya2Vyc1RvTWFwKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MLlxyXG4gKi9cclxuY3JlYXRlUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCkgPT4ge1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuXHJcbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnO1xyXG4gIGltYWdlLnNyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBpbWFnZS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVNyY3NldEZvckluZGV4KHJlc3RhdXJhbnQpO1xyXG4gIGltYWdlLnNpemVzID0gXCIzMDBweFwiO1xyXG4gIGltYWdlLmFsdCA9IGBwaG90b2dyYXBoIG9mICR7cmVzdGF1cmFudC5uYW1lfSByZXN0YXVyYW50YDtcclxuICAvLyBsaS5hcHBlbmQoaW1hZ2UpO1xyXG5cclxuICBcclxuICBcclxuICBjb25zdCBoZWFkTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIGhlYWROYW1lLmNsYXNzTGlzdC5hZGQoJ2hlYWRfbmFtZScpO1xyXG4gIC8vIGRpdkluZm8uYXBwZW5kKGhlYWROYW1lKTtcclxuICBsaS5hcHBlbmQoaGVhZE5hbWUpO1xyXG4gIGhlYWROYW1lLmFwcGVuZChpbWFnZSk7XHJcblxyXG5cclxuICBjb25zdCBkaXZJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgZGl2SW5mby5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbmZvJztcclxuICBsaS50YWJJbmRleCA9IFwiMFwiO1xyXG4gIGxpLmFwcGVuZChkaXZJbmZvKTtcclxuICBcclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcclxuICBuYW1lLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LW5hbWUnO1xyXG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG4gIGRpdkluZm8uYXBwZW5kKG5hbWUpO1xyXG5cclxuICBjb25zdCBmYXZfZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgZmF2X2Rpdi5jbGFzc0xpc3QuYWRkKCdmYXZfbGlzdCcpO1xyXG4gIGhlYWROYW1lLmFwcGVuZChmYXZfZGl2KTtcclxuXHJcbiAgY29uc3QgZmF2b3JpdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gIGZhdm9yaXRlLmNsYXNzTmFtZSA9IFwiaXNfZmF2b3JpdGVcIjtcclxuICBmYXZvcml0ZS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnY2hlY2tib3gnKTtcclxuICAvLyBmYXZvcml0ZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScsICdSZXN0YXVyYW50IEZhdm9yaXRlJyk7XHJcbiAgZmF2b3JpdGUudHlwZSA9IFwiY2hlY2tib3hcIjtcclxuICBmYXZvcml0ZS5uYW1lID0gXCJmYXZvcml0ZVwiO1xyXG4gIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcclxuICAvLyBsYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdpc19mYXZvcml0ZScpO1xyXG4gIGxhYmVsLmNsYXNzTmFtZSA9IFwiY2hlY2tib3gtbGFiZWxcIjtcclxuXHJcbiAgaWYocmVzdGF1cmFudC5pc19mYXZvcml0ZSA9PSAndHJ1ZScgKXtcclxuICAgIGNvbnNvbGUubG9nKHJlc3RhdXJhbnQuaXNfZmF2b3JpdGUpXHJcbiAgICBmYXZvcml0ZS5jaGVja2VkID0gdHJ1ZTtcclxuICAgIGZhdm9yaXRlLnNldEF0dHJpYnV0ZSgnYXJpYS1jaGVja2VkJywgJ3RydWUnKTtcclxuICAgIGZhdm9yaXRlLmlubmVySFRNTCA9IGBSZW1vdmUgJHtyZXN0YXVyYW50Lm5hbWV9IGFzIGEgZmF2b3JpdGVgO1xyXG4gICAgZmF2b3JpdGUudGl0bGUgPSBgUmVtb3ZlICR7cmVzdGF1cmFudC5uYW1lfSBhcyBhIGZhdm9yaXRlYDtcclxuICB9IGVsc2V7XHJcbiAgICBjb25zb2xlLmxvZyhyZXN0YXVyYW50LmlzX2Zhdm9yaXRlKVxyXG4gICAgZmF2b3JpdGUuY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgZmF2b3JpdGUuc2V0QXR0cmlidXRlKCdhcmlhLWNoZWNrZWQnLCAnZmFsc2UnKTtcclxuICAgIGZhdm9yaXRlLmlubmVySFRNTCA9IGBBZGQgJHtyZXN0YXVyYW50Lm5hbWV9IGFzIGEgZmF2b3JpdGVgO1xyXG4gICAgZmF2b3JpdGUudGl0bGUgPSBgQWRkICR7cmVzdGF1cmFudC5uYW1lfSBhcyBhIGZhdm9yaXRlYDtcclxuICB9XHJcbiAgY29uc29sZS5sb2coJ0NoZWNrZWQgOiAnLCBmYXZvcml0ZS5jaGVja2VkKTtcclxuXHJcblxyXG4gIGZhdm9yaXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coJ0NoZWNrZWQgQ2xpY2sgOiAnLCBmYXZvcml0ZS5jaGVja2VkKTtcclxuICAgIFxyXG4gICAgaWYoIGZhdm9yaXRlLmNoZWNrZWQpe1xyXG4gICAgICBmYXZvcml0ZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtY2hlY2tlZCcsICd0cnVlJyk7XHJcbiAgICAgIGZhdm9yaXRlLmlubmVySFRNTCA9IGBSZW1vdmUgJHtyZXN0YXVyYW50Lm5hbWV9IGFzIGEgZmF2b3JpdGVgO1xyXG4gICAgICBmYXZvcml0ZS50aXRsZSA9IGBSZW1vdmUgJHtyZXN0YXVyYW50Lm5hbWV9IGFzIGEgZmF2b3JpdGVgOyBcclxuXHJcbiAgICAgcmV0dXJuIERCSGVscGVyLnNhdmVGYXZvcml0ZShyZXN0YXVyYW50LmlkLCAndHJ1ZScpOyAgXHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgZmF2b3JpdGUuc2V0QXR0cmlidXRlKCdhcmlhLWNoZWNrZWQnLCAnZmFsc2UnKTtcclxuICAgICAgZmF2b3JpdGUuaW5uZXJIVE1MID0gYEFkZCAke3Jlc3RhdXJhbnQubmFtZX0gYXMgYSBmYXZvcml0ZWA7XHJcbiAgICAgIGZhdm9yaXRlLnRpdGxlID0gYEFkZCAke3Jlc3RhdXJhbnQubmFtZX0gYXMgYSBmYXZvcml0ZWA7IFxyXG5cclxuICAgICByZXR1cm4gREJIZWxwZXIuc2F2ZUZhdm9yaXRlKHJlc3RhdXJhbnQuaWQsICdmYWxzZScpO1xyXG4gICAgfVxyXG4gICB9KTtcclxuICBmYXZfZGl2LmFwcGVuZChmYXZvcml0ZSk7XHJcbiAgZmF2X2Rpdi5hcHBlbmQobGFiZWwpO1xyXG4gIGhlYWROYW1lLmFwcGVuZChmYXZfZGl2KTtcclxuXHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIG5laWdoYm9yaG9vZC5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5laWdoYm9yaG9vZDtcclxuICBkaXZJbmZvLmFwcGVuZChuZWlnaGJvcmhvb2QpO1xyXG5cclxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xyXG4gIGRpdkluZm8uYXBwZW5kKGFkZHJlc3MpO1xyXG5cclxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gIG1vcmUuaW5uZXJIVE1MID0gJ1ZpZXcgRGV0YWlscyc7XHJcbiAgbW9yZS5ocmVmID0gREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBkaXZJbmZvLmFwcGVuZChtb3JlKVxyXG5cclxuICByZXR1cm4gbGlcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxyXG4gKi9cclxuYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcclxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5uZXdNYXApO1xyXG4gICAgbWFya2VyLm9uKFwiY2xpY2tcIiwgb25DbGljayk7XHJcbiAgICBmdW5jdGlvbiBvbkNsaWNrKCkge1xyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci5vcHRpb25zLnVybDtcclxuICAgIH1cclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcblxyXG59IFxyXG4vKiBhZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsXHJcbiAgICB9KTtcclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcbn0gKi9cclxuXHJcbiJdfQ==
